(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{116:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=i.a.createContext({}),s=function(e){var t=i.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=s(e.components);return i.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},b=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=s(n),b=a,m=u["".concat(o,".").concat(b)]||u[b]||d[b]||r;return n?i.a.createElement(m,l(l({ref:t},p),{},{components:n})):i.a.createElement(m,l({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=b;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},90:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return s}));var a=n(3),i=n(7),r=(n(0),n(116)),o={id:"write",title:"Writing Data",slug:"../dev-guide/high-level/write"},l={unversionedId:"dev_guide/high_level/write",id:"dev_guide/high_level/write",isDocsHomePage:!1,title:"Writing Data",description:"DynamoDB provides two primary operations for writing data:",source:"@site/docs/dev_guide/high_level/write.md",slug:"/dev_guide/dev-guide/high-level/write",permalink:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/write",editUrl:"https://github.com/alloczero/EfficientDynamoDb/edit/master/website/docs/dev_guide/high_level/write.md",version:"current",sidebar:"someSidebar",previous:{title:"Reading Data",permalink:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/read"},next:{title:"Batch",permalink:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/batch"}},c=[{value:"PutItem",id:"putitem",children:[]},{value:"Update",id:"update",children:[]}],p={toc:c};function s(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"DynamoDB provides two primary operations for writing data:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"PutItem")," - Create a new item, or replace an old item with a new item."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Update")," - Add or update specific attributes of an item.")),Object(r.b)("p",null,"DynamoDB also supports a ",Object(r.b)("inlineCode",{parentName:"p"},"BatchWriteItem")," operation for executing up to 25 ",Object(r.b)("inlineCode",{parentName:"p"},"PutItem")," operations in a single request.\nIt's covered in ",Object(r.b)("a",{parentName:"p",href:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/batch"},"batch operations guide"),"."),Object(r.b)("h2",{id:"putitem"},"PutItem"),Object(r.b)("p",null,"Creates a new item or replaces an old item with a new item.\nIf an item that has the same primary key as the new item already exists in the specified table, the new item completely replaces the existing item."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},'await ddbContext.PutItemAsync(new UserEntity("John", "Doe"));\n')),Object(r.b)("p",null,"Using the fluent API, you can perform a conditional put operation.\nE.g., add a new item if one with the specified primary key doesn't exist, or replace an existing item if it has certain attribute values."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},'await ddbContext.PutItem()\n    .WithItem(new UserEntity("John", "Doe"))\n    .WithCondition(Condition<UserEntity>.On(x => x.Pk).NotExists())\n    .ExecuteAsync();\n')),Object(r.b)("p",null,"You can return the item's attribute values in the same operation by setting ",Object(r.b)("inlineCode",{parentName:"p"},"ReturnValues")," in fluent API.\nIt might be helpful if you want to know the item's state before or after the save.\n",Object(r.b)("inlineCode",{parentName:"p"},"ReturnValues")," enum contains many options, but ",Object(r.b)("inlineCode",{parentName:"p"},"PutItem")," operation only supports ",Object(r.b)("inlineCode",{parentName:"p"},"None"),", ",Object(r.b)("inlineCode",{parentName:"p"},"AllOld"),", and ",Object(r.b)("inlineCode",{parentName:"p"},"AllNew"),"."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},'var item = await ddbContext.PutItem()\n    .WithItem(new UserEntity("John", "Doe"))\n    .WithReturnValues(ReturnValues.AllOld)\n    .ToEntityAsync();\n')),Object(r.b)("p",null,"For more info, check the detailed ",Object(r.b)("a",{parentName:"p",href:"/EfficientDynamoDb/docs/api-reference/put-item"},"PutItem API reference")),Object(r.b)("h2",{id:"update"},"Update"),Object(r.b)("p",null,"Edits an existing item's attributes or adds a new item to the table if it does not already exist.\nYou can put, delete, or add attribute values."),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"Update")," is a rather complicated operation, so you can only use a fluent API to access it.\nThe primary key and at least one update operation must be specified in every request."),Object(r.b)("p",null,"EfficientDynamoDb provides an easy way to build update expressions.\nAll you need to do is pass ",Object(r.b)("inlineCode",{parentName:"p"},"Expression")," referring to the property you want to update to ",Object(r.b)("inlineCode",{parentName:"p"},".On(...)")," method of fluent API.\nAnd then follow it with the action you want to perform, e.g. ",Object(r.b)("inlineCode",{parentName:"p"},"Assign(...)"),"."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},'await ddbContext.Update<UserEntity>()\n    .WithPrimaryKey("partitionKey", "sortKey")\n    .On(x => x.FirstName).Assign("John")\n    .On(x => x.LastName).Assign("Doe")\n    .ExecuteAsync();\n')),Object(r.b)("p",null,"Please, refer to ",Object(r.b)("a",{parentName:"p",href:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/update-expression"},"UpdateExpression developer guide")," for more details about ",Object(r.b)("inlineCode",{parentName:"p"},"UpdateExpression")," builder usage and tricks."),Object(r.b)("p",null,"You can also perform a conditional update on an existing item (insert a new attribute name-value pair if it doesn't exist,or replace an existing name-value pair if it has specific expected attribute values)."),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"Update")," conditions are exactly the same as their ",Object(r.b)("inlineCode",{parentName:"p"},"Put")," condition equivalents both API-wise and behavior-wise."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},'var condition = Condition<UserEntity>\n    .On(x => x.FirstName)\n    .NotEqualsTo("John");\n\nawait ddbContext.Update<UserEntity>()\n    .WithPrimaryKey("partitionKey", "sortKey")\n    .On(x => x.FirstName).Assign("John")\n    .WithCondition(condition)\n    .ExecuteAsync();\n')),Object(r.b)("p",null,"You can return the item's attribute values in the same operation by setting ",Object(r.b)("inlineCode",{parentName:"p"},"ReturnValues")," in fluent API.\nIt might be helpful if you want to know the item's state before or after the update."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},'var oldValues = await ddbContext.Update<UserEntity>()\n    .WithPrimaryKey("partitionKey", "sortKey")\n    .On(x => x.FirstName).Assign("John")\n    .WithReturnValues(ReturnValues.UpdatedOld)\n    .ToEntityAsync();\n')),Object(r.b)("p",null,"For more info, check the detailed ",Object(r.b)("a",{parentName:"p",href:"/EfficientDynamoDb/docs/api-reference/update"},"Update API reference")))}s.isMDXComponent=!0}}]);