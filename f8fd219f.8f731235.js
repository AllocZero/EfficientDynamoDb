(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{113:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return s})),t.d(n,"toc",(function(){return l})),t.d(n,"default",(function(){return p}));var i=t(3),o=t(7),r=(t(0),t(119)),a={id:"conditions",title:"Building Conditions",slug:"../dev-guide/high-level/conditions"},s={unversionedId:"dev_guide/high_level/conditions",id:"dev_guide/high_level/conditions",isDocsHomePage:!1,title:"Building Conditions",description:"This guide focuses on EfficientDynamoDb's API for building conditions.",source:"@site/docs/dev_guide/high_level/conditions.md",slug:"/dev_guide/dev-guide/high-level/conditions",permalink:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/conditions",editUrl:"https://github.com/alloczero/EfficientDynamoDb/edit/master/website/docs/dev_guide/high_level/conditions.md",version:"current",sidebar:"someSidebar",previous:{title:"Custom Converters",permalink:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/converters"},next:{title:"Building Update Expressions",permalink:"/EfficientDynamoDb/docs/dev_guide/dev-guide/high-level/update-expression"}},l=[{value:"Overview",id:"overview",children:[]},{value:"Getting started",id:"getting-started",children:[{value:"Conditions on array elements",id:"conditions-on-array-elements",children:[]},{value:"Nested properties",id:"nested-properties",children:[]},{value:"Comparison with other attributes",id:"comparison-with-other-attributes",children:[]},{value:"Multiple conditions on a single entity",id:"multiple-conditions-on-a-single-entity",children:[]}]},{value:"Joining multiple conditions",id:"joining-multiple-conditions",children:[{value:"Joiner API",id:"joiner-api",children:[]},{value:"Logical operators API",id:"logical-operators-api",children:[]},{value:"Using both APIs together",id:"using-both-apis-together",children:[]}]}],c={toc:l};function p(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(i.a)({},c,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("p",null,"This guide focuses on EfficientDynamoDb's API for building conditions.\nIt's assumed that you already familiar with condition expressions in DynamoDb.\nIf not, please check out ",Object(r.b)("a",{parentName:"p",href:"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Expressions.ConditionExpressions.html"},"official aws docs")," and ",Object(r.b)("a",{parentName:"p",href:"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Expressions.OperatorsAndFunctions.html"},"comparison operators reference")," for better understanding of topics covered in this section."),Object(r.b)("h2",{id:"overview"},"Overview"),Object(r.b)("p",null,"EfficientDynamoDb aims to simplify condition expressions building by providing abstraction over DynamoDB expressions syntax."),Object(r.b)("p",null,"Benefits of our API:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Removes the requirement of managing ",Object(r.b)("inlineCode",{parentName:"li"},"ExpressionAttributeNames"),", ",Object(r.b)("inlineCode",{parentName:"li"},"ExpressionAttributeValues"),", and handling reserved words."),Object(r.b)("li",{parentName:"ul"},"Easy refactoring and usage search in your favorite IDE.")),Object(r.b)("h2",{id:"getting-started"},"Getting started"),Object(r.b)("p",null,"The simplest way of creating a condition is using the ",Object(r.b)("inlineCode",{parentName:"p"},"Condition<T>.On(...)")," static factory method:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var condition = Condition<EntityClass>.On(x => x.YourProperty).EqualsTo(10);\n")),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"On(...)")," accepts an expression that should point to property marked by ",Object(r.b)("inlineCode",{parentName:"p"},"DynamoDBProperty")," attribute, element inside the collection, or the nested property of another object."),Object(r.b)("h3",{id:"conditions-on-array-elements"},"Conditions on array elements"),Object(r.b)("p",null,"Condition for the specific element inside the collection:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var condition = Condition<EntityClass>.On(x => x.YourList[3]).EqualsTo(10);\n")),Object(r.b)("p",null,"Currently, you can use only number literals, constants, fields, or variables inside the indexer.\nYou can't use methods or properties to get the index."),Object(r.b)("p",null,"Example of incorrect method usage to get the index. ",Object(r.b)("strong",{parentName:"p"},"The following code won't work!")),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var condition = Condition<EntityClass>.On(x => x.YourList[Getindex()]).EqualsTo(10);\n")),Object(r.b)("p",null,"If you need to get an index from the method, you can save it to local variable first:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var index = Getindex();\nvar condition = Condition<EntityClass>.On(x => x.YourList[index]).EqualsTo(10);\n")),Object(r.b)("h3",{id:"nested-properties"},"Nested properties"),Object(r.b)("p",null,"You may access nested properies of lists and objects.\nE.g., the following condition is valid:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var condition = Condition<EntityClass>.On(x => x.TopLvlProperty.NestedList[3].MoreNestedProperty).EqualsTo(10);\n")),Object(r.b)("h3",{id:"comparison-with-other-attributes"},"Comparison with other attributes"),Object(r.b)("p",null,"The majority of DDB condition operations support comparison with other attributes instead of ourside value.\nYou can pass an expression inside the operation method in the same way you do in ",Object(r.b)("inlineCode",{parentName:"p"},"On(...)"),":"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var condition = Condition<EntityClass>.On(x => x.SomeProperty).EqualsTo(x => x.AnotherProperty);\n")),Object(r.b)("p",null,"Some operations like ",Object(r.b)("inlineCode",{parentName:"p"},"Between")," accepts even combination of value and another property:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var condition = Condition<EntityClass>.On(x => x.SomeProperty).EqualsTo(minValueVariable, x => x.MaxValueProperty);\n")),Object(r.b)("h3",{id:"multiple-conditions-on-a-single-entity"},"Multiple conditions on a single entity"),Object(r.b)("p",null,"A lot of times, you need to create multiple conditions on a single entity.\nIn this case, the alternative API may be handy:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var filter = Condition.ForEntity<EntityClass>();\n\nvar firstCondition = filter.On(x => x.SomeProperty).EqualsTo(10);\nvar secondCondition = filter.On(x => x.RareProperty).Exists();\n")),Object(r.b)("p",null,"You can use these conditions in separate requests or join them into a single condition which is expained in the following section."),Object(r.b)("h2",{id:"joining-multiple-conditions"},"Joining multiple conditions"),Object(r.b)("p",null,"There are two ways of combining multiple conditions into one expression."),Object(r.b)("h3",{id:"joiner-api"},"Joiner API"),Object(r.b)("p",null,"Use any combination of ",Object(r.b)("inlineCode",{parentName:"p"},"Joiner.And(...)")," and ",Object(r.b)("inlineCode",{parentName:"p"},"Joiner.Or(...)")," methods to create a complex condition."),Object(r.b)("p",null,"For example, DDB condition ",Object(r.b)("inlineCode",{parentName:"p"},"#firstName = :firstName AND (#age < :lowerAgeLimit OR #age > :upperAgeLimit) AND begins_with(#lastName, :lastNamePrefix)")," will look like this:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var filter = Condition.ForEntity<EntityClass>();\nvar condition = Joiner.And(\n        filter.On(x => x.FirstName).EqualsTo(firstNameValue),\n        Joiner.Or(\n            filter.On(x => x.Age).LessThan(lowerAgeLimit),\n            filter.On(x => x.Age).GreaterThan(upperAgeLimit)\n        ),\n        filter.On(x => x.LastName).BeginsWith(lastNamePrefix)\n    );\n")),Object(r.b)("h3",{id:"logical-operators-api"},"Logical operators API"),Object(r.b)("p",null,"You might find Joiner API quite verbose and difficult to read when there are a lot of ",Object(r.b)("inlineCode",{parentName:"p"},"AND"),"/",Object(r.b)("inlineCode",{parentName:"p"},"OR")," operators.\nThat's where logical operators come to the rescue.\nConditions in EfficientDynamoDb support logical ",Object(r.b)("inlineCode",{parentName:"p"},"&")," and ",Object(r.b)("inlineCode",{parentName:"p"},"|")," for combining multiple into one."),Object(r.b)("p",null,"The same DDB expression from the Joiner API example looks like this:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var filter = Condition.ForEntity<EntityClass>();\nvar condition = filter.On(x => x.FirstName).EqualsTo(firstNameValue) \n    & (filter.On(x => x.Age).LessThan(lowerAgeLimit) | filter.On(x => x.Age).GreaterThan(upperAgeLimit)) \n    & filter.On(x => x.LastName).BeginsWith(lastNamePrefix)\n")),Object(r.b)("p",null,"Note that this API follows all logical operator rules, e.g., you can use parentheses to change execution order."),Object(r.b)("h3",{id:"using-both-apis-together"},"Using both APIs together"),Object(r.b)("p",null,"It's possible to use both Joiner and Logical operators API together to build a single query."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-csharp"},"var filter = Condition.ForEntity<EntityClass>();\nvar condition = Joiner.And(\n        filter.On(x => x.FirstName).EqualsTo(firstNameValue),\n        filter.On(x => x.Age).LessThan(lowerAgeLimit) | filter.On(x => x.Age).GreaterThan(upperAgeLimit),\n        filter.On(x => x.LastName).BeginsWith(lastNamePrefix)\n    );\n")))}p.isMDXComponent=!0},119:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return m}));var i=t(0),o=t.n(i);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=o.a.createContext({}),p=function(e){var n=o.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=p(e.components);return o.a.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},b=o.a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,a=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(t),b=i,m=d["".concat(a,".").concat(b)]||d[b]||u[b]||r;return t?o.a.createElement(m,s(s({ref:n},c),{},{components:t})):o.a.createElement(m,s({ref:n},c))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,a=new Array(r);a[0]=b;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var c=2;c<r;c++)a[c]=t[c];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);